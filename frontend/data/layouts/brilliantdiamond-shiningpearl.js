(() => {
	const GAME_KEYS = ["brilliantdiamond", "shiningpearl"];

	const P = (parentId) => [parentId];          			// parent-only task
	const C = (parentId, childId) => [parentId, childId]; 	// parent + child task

	const DESKTOP_LAYOUT = {
		"catching": [
			[P(1)],
			[C(1, 1), C(1, 2), C(1, 3)],
		],
		"fashion": [
			[P(1), P(2), P(3), P(4)],
			[P(5), P(6), P(7), P(8)],
			[P(9), P(10), P(11)],
		],
		"statues": [
			[P(1)],
			[C(1, 1), C(1, 2), C(1, 3), C(1, 4), C(1, 5), C(1, 6)],
			[C(1, 7), C(1, 8), C(1, 9), C(1, 10), C(1, 11), C(1, 12)],
			[C(1, 13), C(1, 14), C(1, 15), C(1, 16), C(1, 17), C(1, 18)],
			[C(1, 19), C(1, 20), C(1, 21), C(1, 22), C(1, 23), C(1, 24)],
			[C(1, 25), C(1, 26), C(1, 27), C(1, 28), C(1, 29), C(1, 30)],
			[C(1, 31), C(1, 32), C(1, 33), C(1, 34), C(1, 35), C(1, 36)],
			[C(1, 37), C(1, 38), C(1, 39), C(1, 40), C(1, 41), C(1, 42)],
			[C(1, 43), C(1, 44), C(1, 45), C(1, 46), C(1, 47), C(1, 48)],
			[C(1, 49), C(1, 50), C(1, 51), C(1, 52), C(1, 53), C(1, 54)],
			[C(1, 55), C(1, 56), C(1, 57), C(1, 58), C(1, 59), C(1, 60)],
			[C(1, 61), C(1, 62), C(1, 63), C(1, 64), C(1, 65), C(1, 66)],
			[C(1, 67), C(1, 68), C(1, 69), C(1, 70), C(1, 71), C(1, 72)],
			[C(1, 73), C(1, 74), C(1, 75), C(1, 76), C(1, 77), C(1, 78)],
			[C(1, 79), C(1, 80), C(1, 81), C(1, 82), C(1, 83), C(1, 84)],
			[C(1, 85), C(1, 86), C(1, 87), C(1, 88), C(1, 89), C(1, 90)],
			[C(1, 91), C(1, 92), C(1, 93), C(1, 94), C(1, 95), C(1, 96)],
			[C(1, 97), C(1, 98), C(1, 99), C(1, 100), C(1, 101), C(1, 102)],
			[C(1, 103), C(1, 104), C(1, 105), C(1, 106), C(1, 107), C(1, 108)],
			[C(1, 109), C(1, 110), C(1, 111), C(1, 112), C(1, 113), C(1, 114)],
			[C(1, 115), C(1, 116), C(1, 117), C(1, 118), C(1, 119), C(1, 120)],
			[C(1, 121), C(1, 122), C(1, 123), C(1, 124), C(1, 125), C(1, 126)],
			[C(1, 127), C(1, 128), C(1, 129), C(1, 130), C(1, 131), C(1, 132)],
			[C(1, 133), C(1, 134), C(1, 135), C(1, 136), C(1, 137), C(1, 138)],
			[C(1, 139), C(1, 140), C(1, 141), C(1, 142), C(1, 143), C(1, 144)],
			[C(1, 145), C(1, 146), C(1, 147), C(1, 148), C(1, 149), C(1, 150)],
			[C(1, 151), C(1, 152), C(1, 153), C(1, 154), C(1, 155), C(1, 156)],
			[C(1, 157), C(1, 158), C(1, 159), C(1, 160), C(1, 161), C(1, 162)],
			[C(1, 163), C(1, 164), C(1, 165), C(1, 166), C(1, 167), C(1, 168)],
			[C(1, 169), C(1, 170), C(1, 171), C(1, 172), C(1, 173), C(1, 174)],
			[C(1, 175), C(1, 176), C(1, 177), C(1, 178), C(1, 179), C(1, 180)],
			[C(1, 181), C(1, 182), C(1, 183), C(1, 184), C(1, 185), C(1, 186)],
			[C(1, 187), C(1, 188), C(1, 189), C(1, 190), C(1, 191), C(1, 192)],
			[C(1, 193), C(1, 194), C(1, 195), C(1, 196), C(1, 197), C(1, 198)],
			[C(1, 199), C(1, 200), C(1, 201), C(1, 202), C(1, 203), C(1, 204)],
			[C(1, 205), C(1, 206), C(1, 207), C(1, 208), C(1, 209), C(1, 210)],
			[C(1, 211), C(1, 212), C(1, 213), C(1, 214), C(1, 215), C(1, 216)],
			[C(1, 217), C(1, 218), C(1, 219), C(1, 220), C(1, 221), C(1, 222)],
			[C(1, 223)],
			[spacer], [spacer],
			[P(2)],
			[C(2, 1), C(2, 2), C(2, 3), C(2, 4), C(2, 5), C(2, 6)],
			[C(2, 7), C(2, 8), C(2, 9), C(2, 10), C(2, 11), C(2, 12)],
			[C(2, 13), C(2, 14), C(2, 15), C(2, 16), C(2, 17), C(2, 18)],
			[C(2, 19), C(2, 20), C(2, 21), C(2, 22), C(2, 23), C(2, 24)],
			[C(2, 25), C(2, 26), C(2, 27), C(2, 28), C(2, 29), C(2, 30)],
			[C(2, 31), C(2, 32), C(2, 33), C(2, 34), C(2, 35), C(2, 36)],
			[C(2, 37), C(2, 38), C(2, 39), C(2, 40), C(2, 41), C(2, 42)],
			[C(2, 43), C(2, 44), C(2, 45), C(2, 46), C(2, 47), C(2, 48)],
			[C(2, 49), C(2, 50), C(2, 51), C(2, 52), C(2, 53), C(2, 54)],
			[C(2, 55), C(2, 56), C(2, 57), C(2, 58), C(2, 59), C(2, 60)],
			[C(2, 61), C(2, 62), C(2, 63), C(2, 64), C(2, 65), C(2, 66)],
			[C(2, 67), C(2, 68), C(2, 69), C(2, 70), C(2, 71), C(2, 72)],
			[C(2, 73), C(2, 74), C(2, 75), C(2, 76), C(2, 77), C(2, 78)],
			[C(2, 79), C(2, 80), C(2, 81), C(2, 82), C(2, 83), C(2, 84)],
			[C(2, 85), C(2, 86), C(2, 87), C(2, 88), C(2, 89), C(2, 90)],
			[C(2, 91), C(2, 92), C(2, 93), C(2, 94), C(2, 95), C(2, 96)],
			[C(2, 97), C(2, 98), C(2, 99), C(2, 100), C(2, 101), C(2, 102)],
			[C(2, 103), C(2, 104), C(2, 105), C(2, 106), C(2, 107), C(2, 108)],
			[C(2, 109), C(2, 110), C(2, 111), C(2, 112), C(2, 113), C(2, 114)],
			[C(2, 115), C(2, 116), C(2, 117), C(2, 118), C(2, 119), C(2, 120)],
			[C(2, 121), C(2, 122), C(2, 123), C(2, 124), C(2, 125), C(2, 126)],
			[C(2, 127), C(2, 128), C(2, 129), C(2, 130), C(2, 131), C(2, 132)],
			[C(2, 133), C(2, 134), C(2, 135), C(2, 136), C(2, 137), C(2, 138)],
			[C(2, 139), C(2, 140), C(2, 141), C(2, 142), C(2, 143), C(2, 144)],
			[C(2, 145), C(2, 146), C(2, 147), C(2, 148), C(2, 149), C(2, 150)],
			[C(2, 151), C(2, 152), C(2, 153), C(2, 154), C(2, 155), C(2, 156)],
			[C(2, 157), C(2, 158), C(2, 159), C(2, 160), C(2, 161), C(2, 162)],
			[C(2, 163), C(2, 164), C(2, 165), C(2, 166), C(2, 167), C(2, 168)],
			[C(2, 169), C(2, 170), C(2, 171), C(2, 172), C(2, 173), C(2, 174)],
			[C(2, 175), C(2, 176), C(2, 177), C(2, 178), C(2, 179), C(2, 180)],
			[C(2, 181), C(2, 182), C(2, 183), C(2, 184), C(2, 185), C(2, 186)],
			[C(2, 187), C(2, 188), C(2, 189), C(2, 190), C(2, 191), C(2, 192)],
			[C(2, 193), C(2, 194), C(2, 195), C(2, 196), C(2, 197), C(2, 198)],
			[C(2, 199), C(2, 200), C(2, 201), C(2, 202), C(2, 203), C(2, 204)],
			[C(2, 205), C(2, 206)],
		],
		"thms": [
			[P(1)],
			[C(1, 1), C(1, 2), C(1, 3), C(1, 4)],
			[C(1, 5), C(1, 6), C(1, 7), C(1, 8)],
			[P(2)],
			[C(2, 1), C(2, 2), C(2, 3), C(2, 4), C(2, 5)],
			[C(2, 6), C(2, 7), C(2, 8), C(2, 9), C(2, 10)],
			[C(2, 11), C(2, 12), C(2, 13), C(2, 14), C(2, 15)],
			[C(2, 16), C(2, 17), C(2, 18), C(2, 19), C(2, 20)],
			[C(2, 21), C(2, 22), C(2, 23), C(2, 24), C(2, 25)],
			[C(2, 26), C(2, 27), C(2, 28), C(2, 29), C(2, 30)],
			[C(2, 31), C(2, 32), C(2, 33), C(2, 34), C(2, 35)],
			[C(2, 36), C(2, 37), C(2, 38), C(2, 39), C(2, 40)],
			[C(2, 41), C(2, 42), C(2, 43), C(2, 44), C(2, 45)],
			[C(2, 46), C(2, 47), C(2, 48), C(2, 49), C(2, 50)],
			[C(2, 51), C(2, 52), C(2, 53), C(2, 54), C(2, 55)],
			[C(2, 56), C(2, 57), C(2, 58), C(2, 59), C(2, 60)],
			[C(2, 61), C(2, 62), C(2, 63), C(2, 64), C(2, 65)],
			[C(2, 66), C(2, 67), C(2, 68), C(2, 69), C(2, 70)],
			[C(2, 71), C(2, 72), C(2, 73), C(2, 74), C(2, 75)],
			[C(2, 76), C(2, 77), C(2, 78), C(2, 79), C(2, 80)],
			[C(2, 81), C(2, 82), C(2, 83), C(2, 84), C(2, 85)],
			[C(2, 86), C(2, 87), C(2, 88), C(2, 89), C(2, 90)],
			[C(2, 91), C(2, 92), C(2, 93), C(2, 94), C(2, 95)],
			[C(2, 96), C(2, 97), C(2, 98), C(2, 99), C(2, 100)],
		],
		"extra-credit": [
			[P(1)],
		],
	};

	const COMPACT_LAYOUT = DESKTOP_LAYOUT;

	function buildTaskRowsForGame(gameKey, sharedLayout) {
		const out = {};

		for (const [sectionSuffix, rows] of Object.entries(sharedLayout)) {
			const sectionKey = `${gameKey}:${sectionSuffix}`;

			out[sectionKey] = (rows || []).map((row) =>
				(row || []).map((ref) => {
					if (typeof ref === "string") return ref;

					const parentId = ref?.[0];
					const childId = ref?.[1];

					if (parentId == null) return null;

					return childId == null
						? `${sectionKey}:${pad3(parentId)}`
						: `${sectionKey}:${pad3(parentId)}:${pad3(childId)}`;
				}).filter(Boolean)
			);
		}

		return out;
	}

	for (const gameKey of GAME_KEYS) {
		const desktopLayout = buildTaskRowsForGame(gameKey, DESKTOP_LAYOUT);
		const compactLayout = buildTaskRowsForGame(gameKey, COMPACT_LAYOUT);

		PPGC.register({
			layoutVariants: {
				desktop: { taskRows: desktopLayout },
				compact: { taskRows: compactLayout },
			},
		});
	}
})();