generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Objective {
  id            String   @id
  title         String
  gameId        String?
  meta          String?          // store JSON-as-string if you want
  checklistItems ChecklistItem[]
  eqMembers     ObjectiveEquivalence[]
}

model ChecklistItem {
  id          String @id
  gameId      String
  categoryKey String
  objectiveId String
  objective   Objective @relation(fields: [objectiveId], references: [id])
  sortOrder   Int @default(0)
  meta        String?
  @@index([gameId, categoryKey, sortOrder])
}

model ObjectiveEquivalence {
  equivGroupId String
  objectiveId  String
  objective    Objective @relation(fields: [objectiveId], references: [id])
  @@id([equivGroupId, objectiveId])
  @@unique([equivGroupId, objectiveId], name: "equivGroupId_objectiveId") // add this
}

model UserObjectiveProgress {
  userId      String
  objectiveId String
  status      String
  source      String
  updatedAt   DateTime @updatedAt
  @@id([userId, objectiveId])
  @@index([userId])
}
